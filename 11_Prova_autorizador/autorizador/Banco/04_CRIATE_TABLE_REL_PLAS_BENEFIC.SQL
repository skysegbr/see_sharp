CREATE TABLE TB_REL_PLAS_BENEFIC (
    COD_PLAS         NUMBER(6),
    CNPJ_PLAS        NUMBER(14),
    COD_BENEFICIARIO NUMBER(6),
    MATRICULA        VARCHAR2(16),
    DT_INI      DATE,
    DT_FIM      DATE
);


COMMENT ON COLUMN TB_REL_PLAS_BENEFIC.COD_PLAS IS 'CODIGO IDENTIFICADOR DO PLANO DE SAUDE';
COMMENT ON COLUMN TB_REL_PLAS_BENEFIC.CNPJ_PLAS IS 'CNPJ DO PLANO DE SAUDE';
COMMENT ON COLUMN TB_REL_PLAS_BENEFIC.COD_BENEFICIARIO IS 'CODIGO DO BENEFICIARIO DO PLANO DE SAUDE';
COMMENT ON COLUMN TB_REL_PLAS_BENEFIC.MATRICULA IS 'IDENTIFICADOR UNICO NO PLANO DE SAUDE';
COMMENT ON COLUMN TB_REL_PLAS_BENEFIC.DT_INI IS 'DATA INICIO DO STATUS';
COMMENT ON COLUMN TB_REL_PLAS_BENEFIC.DT_FIM IS 'DATA FIM DO STATUS';

ALTER TABLE TB_REL_PLAS_BENEFIC
    ADD CONSTRAINT PK_BENEFICIARIO_PLANO PRIMARY KEY (COD_PLAS, COD_BENEFICIARIO, MATRICULA, DT_FIM)
    USING INDEX;


ALTER TABLE TB_REL_PLAS_BENEFIC
ADD CONSTRAINT FK_REL_COD_PLAS FOREIGN KEY (COD_PLAS, CNPJ_PLAS)
  REFERENCES TB_PLANO_SAUDE(COD_PLAS, CNPJ_PLAS);


ALTER TABLE TB_REL_PLAS_BENEFIC
ADD CONSTRAINT FK_COD_BENEFICIARIO FOREIGN KEY (COD_BENEFICIARIO)
  REFERENCES TB_BENEFICIARIO(COD_BENEFICIARIO);


CREATE INDEX INX_REL_PLAS_BENEFIC ON TB_REL_PLAS_BENEFIC (MATRICULA, DT_FIM);
