CREATE TABLE TB_MOVIMENTO_FARMACIA (
    COD_VENDA        NUMBER(12),
    COD_AUTORIZACAO  NUMBER(12),
    ORDEM_ITEM       NUMBER(3),
    QTD_ITENS        NUMBER(3),
    TOTAL_VENDA      NUMBER(6),
    STA_VENDA        NUMBER(2),
    DT_VENDA         DATE
);


COMMENT ON COLUMN TB_MOVIMENTO_FARMACIA.COD_VENDA IS 'CODIGO UNICO DA VENDA';
COMMENT ON COLUMN TB_MOVIMENTO_FARMACIA.COD_AUTORIZACAO IS 'FK - TB_AUTORIZACAO';
COMMENT ON COLUMN TB_MOVIMENTO_FARMACIA.ORDEM_ITEM IS 'FK - TB_AUTORIZACAO';
COMMENT ON COLUMN TB_MOVIMENTO_FARMACIA.QTD_ITENS IS 'QUANTIDADE DE ITENS DA VENDA';
COMMENT ON COLUMN TB_MOVIMENTO_FARMACIA.TOTAL_VENDA IS 'TOTAL DA FATURA';
COMMENT ON COLUMN TB_MOVIMENTO_FARMACIA.STA_VENDA IS 'STATUS DA VENDA';
COMMENT ON COLUMN TB_MOVIMENTO_FARMACIA.DT_VENDA IS 'DATA DA VENDA';

ALTER TABLE TB_MOVIMENTO_FARMACIA
ADD CONSTRAINT FK_COD_AUTORIZACAO FOREIGN KEY (COD_AUTORIZACAO, ORDEM_ITEM)
  REFERENCES TB_AUTORIZACAO(COD_AUTORIZACAO, ORDEM_ITEM);


ALTER TABLE TB_MOVIMENTO_FARMACIA
    ADD CONSTRAINT PK_TB_MOVIMENTO_FARMACIA PRIMARY KEY (COD_VENDA, COD_AUTORIZACAO)
    USING INDEX;


CREATE INDEX INX_MOVIMENTO_FARMACIA_DT_VENDA ON TB_MOVIMENTO_FARMACIA (COD_VENDA, DT_VENDA);


CREATE INDEX INX_MOVIMENTO_FARMACIA_DT_AUTOR ON TB_MOVIMENTO_FARMACIA (COD_AUTORIZACAO, DT_VENDA);


